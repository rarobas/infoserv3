// Function to avoid polluting the global scope
(function () {
  "use strict";

  // Select elements
  const sidebarToggle = document.getElementById("sidebarToggle");
  const sidebarToggleTop = document.getElementById("sidebarToggleTop");
  const body = document.body;
  const sidebar = document.querySelector(".sidebar");
  const scrollToTopButton = document.querySelector(".scroll-to-top");

  // Toggle sidebar on click
  sidebarToggle.addEventListener("click", function (event) {
    body.classList.toggle("sidebar-toggled");
    sidebar.classList.toggle("toggled");

    if (sidebar.classList.contains("toggled")) {
      const collapses = sidebar.querySelectorAll(".collapse");
      for (const collapse of collapses) {
        collapse.classList.remove("show"); // Assuming collapse uses Bootstrap
      }
    }
  });

  sidebarToggleTop.addEventListener("click", function (event) {
    body.classList.toggle("sidebar-toggled");
    sidebar.classList.toggle("toggled");

    if (sidebar.classList.contains("toggled")) {
      const collapses = sidebar.querySelectorAll(".collapse");
      for (const collapse of collapses) {
        collapse.classList.remove("show"); // Assuming collapse uses Bootstrap
      }
    }
  });
  
  // Toggle sidebar on resize
  window.addEventListener("resize", function () {
    if (window.innerWidth < 768) {
      const collapses = sidebar.querySelectorAll(".collapse");
      for (const collapse of collapses) {
        collapse.classList.remove("show"); // Assuming collapse uses Bootstrap
      }
    } else if (window.innerWidth < 480 && !sidebar.classList.contains("toggled")) {
      body.classList.add("sidebar-toggled");
      sidebar.classList.add("toggled");   

      const collapses = sidebar.querySelectorAll(".collapse");
      for (const collapse of collapses) {
        collapse.classList.remove("show"); // Assuming collapse uses Bootstrap
      }
    }
  });

  // Handle scroll on fixed nav sidebar
  if (body.classList.contains("fixed-nav")) {
    sidebar.addEventListener("wheel", function (event) {
      const delta = event.deltaY || -event.detail; // Normalize scroll direction
      this.scrollTop += delta * 30;
      event.preventDefault();
    });
  }

  // Show/hide scroll to top button
  document.addEventListener("scroll", function () {
    if (document.documentElement.scrollTop > 100) {
      scrollToTopButton.classList.add("show"); // Assuming scroll-to-top uses a show class
    } else {
      scrollToTopButton.classList.remove("show"); // Assuming scroll-to-top uses a show class
    }
  });

  // Scroll to top on button click
  scrollToTopButton.addEventListener("click", function (event) {
    const target = document.querySelector(this.getAttribute("href"));
    if (target) {
      const targetTop = target.getBoundingClientRect().top + window.pageYOffset;   

      document.documentElement.scrollTop = targetTop;
      event.preventDefault();
    }
  });
})();